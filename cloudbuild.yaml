timeout: 120s

options:
  dynamic_substitutions: 'true'
  substitution_option: 'ALLOW_LOOSE'
substitutions:
  _REGION: 'europe-docker.pkg.dev'
  _FILE_NAME: 'null'

steps:
  - name: 'maven:3.8.4-eclipse-temurin-17-alpine'
    entrypoint: 'bash'
    args: ['echo ${_FILE_NAME} | exit 0']
    env:
      - "${_FILE_NAME}=mvn -q -Dexec.executable=echo -Dexec.args='${project.artifactId}-${project.version}.jar' --non-recursive exec:exec"
#  - name: 'maven:3.8.4-eclipse-temurin-17-alpine'
#    entrypoint: 'mvn'
#    args: ['test']
#    dir: 'helloworld'
#  - name: 'maven:3.8.4-eclipse-temurin-17-alpine'
#    entrypoint: 'mvn'
#    args: ['package', '-Dmaven.test.skip=true']
#    dir: 'helloworld'
#  - name: 'maven:3.8.4-eclipse-temurin-17-alpine'
#    entrypoint: 'echo'
#    args:
#      - '################'
#      - '$PROJECT_NUMBER'
#      - '################'
#
#artifacts:
#  objects:
#    location: 'gs://prod-rest_cloudbuild/hello-world'
#    paths: ['helloworld/target/*.jar']






# example 1
#  - name: 'gcr.io/cloud-builders/docker'
#    entrypoint: 'bash'
#    args: ['-c', 'docker pull ${_REGION}/$PROJECT_ID/rest-api/$REPO_NAME:latest || exit 0']
#
#  - name: 'gcr.io/cloud-builders/docker'
#    args: [ 'build',
#            '-t', '${_REGION}/${PROJECT_ID}/rest-api/$REPO_NAME:$SHORT_SHA',
#            '-t', '${_REGION}/${PROJECT_ID}/rest-api/$REPO_NAME:latest',
#            '--cache-from', '${_REGION}/${PROJECT_ID}/rest-api/$REPO_NAME:latest',
#            '-f', 'Dockerfile',
#            '.' ]
#
#
#images:
#  - '${_REGION}/${PROJECT_ID}/rest-api/$REPO_NAME:$SHORT_SHA'
#  - '${_REGION}/${PROJECT_ID}/rest-api/$REPO_NAME:latest'

# example 2
#  - name: "alpine"
#    args: ['echo', '$_TEST_ENV']
#substitutions:
#  _TEST_ENV: Hello World from Alpine STEP in Google Cloud Build.


